# abstlang - Abstract Language Specification

LLM向け知識表現のための抽象言語仕様

## 概要

abstlangは、人間の知識や関係性を形式的に定義し、LLMが推論可能な形式で表現するための言語である。

**特徴**:
- 3値論理（TRUE, FALSE, NULL）による知識状態の表現
- 関係の対称性/非対称性の形式的定義
- 自然言語への変換規則
- 推論規則の明示的記述

---

## 型定義

```
BOOL := {TRUE, FALSE, NULL}

TRUE  = 真（知っている、である）
FALSE = 偽（知っている、でない）
NULL  = 不明（知らない）

人物 := {太郎, 花子, 次郎, ...}
状態 := {存在しない, 存命でない, ...}
```

---

## 関係の定義

### 構文

```
∀a,b ∈ 概念:
  R(a, b) = TRUE  ↔ "{TRUE説明文}"  または 推論規則
  R(a, b) = FALSE ↔ "{FALSE説明文}" または 推論規則
  R(a, b) = NULL  ↔ "{NULL説明文}"  または 推論規則
```

関係Rの定義とは、各BOOL値に対して説明文または推論規則を設定することである。

---

## 関係の分類

### 非対称関係

```
非対称関係(R1, R2) :=
  ∀a,b ∈ 概念:
    % 推論規則
    R1(a, b) = TRUE → R1(b, a) = FALSE       % 排他性
    ∀v ∈ BOOL: R1(a, b) = v ↔ R2(b, a) = v   % 相互変換
```

例: 親/子, 兄/弟, 上司/部下

### 対称関係

```
対称関係(R) :=
  ∀a,b ∈ 概念:
    % 推論規則
    ∀v ∈ BOOL: R(a, b) = v ↔ R(b, a) = v
```

例: 親子関係, 兄弟関係, 友人関係

---

## 人間関係の定義

### 人間関係（基底）

引数の型（人物/状態）ごとにパターンを分けて定義する。

```
人間関係(R) :=

  % =================================
  % パターン1: 人物 × 人物
  % =================================
  ∀a,b ∈ 人物:
    R(a, b) := "aはbのRである"
      R(a, b) = TRUE  ↔ "aはbのRである"
      R(a, b) = FALSE ↔ "aはbのRではない"
      R(a, b) = NULL  ↔ "aはbのRか不明である"

  % =================================
  % パターン2: 状態 × 人物
  % =================================
  ∀s ∈ 状態, ∀b ∈ 人物:
    R(s, b) := "bのRはs"
      R(s, b) = TRUE  ↔ "bのRはs"
      R(s, b) = FALSE ↔ "bのRは~s"
      R(s, b) = NULL  ↔ "bのRはsか不明である"
```

### 非対称人間関係

```
非対称人間関係(R) :=
  Rは人間関係であり、かつ以下を満たす:

  ∀a,b ∈ 人物:
    R(a, b) = TRUE → R(b, a) = FALSE
```

### 対称人間関係

```
対称人間関係(R) :=
  Rは人間関係であり、かつ以下を満たす:

  ∀a,b ∈ 人物:
    ∀v ∈ BOOL: R(a, b) = v ↔ R(b, a) = v
```

### 対の関係

```
対(R1, R2) :=
  R1, R2は非対称人間関係であり、かつ以下を満たす:

  ∀a,b ∈ 人物:
    ∀v ∈ BOOL: R1(a, b) = v ↔ R2(b, a) = v
```

---

## 関係名の導出

非対称関係から対称関係を導出できる。

```
非対称人間関係(R1, R2) かつ 対称人間関係(S) のとき:

R1(a, b) = TRUE  → S(a, b) = TRUE
R1(a, b) = FALSE → S(a, b) = FALSE
R1(a, b) = NULL  → S(a, b) = NULL
```

例:
```
非対称人間関係(親, 子)
対称人間関係(親子関係)

親(a, b) = TRUE → 親子関係(a, b) = TRUE
```

---

## 適用例

### 親/子

```
% 宣言
非対称人間関係(親)
非対称人間関係(子)
対(親, 子)
対称人間関係(親子関係)

% 人間関係(親) より自動的に定義される:
% パターン1: 人物 × 人物
∀a,b ∈ 人物:
  親(a, b) := "aはbの親である"
    親(a, b) = TRUE  ↔ "aはbの親である"
    親(a, b) = FALSE ↔ "aはbの親ではない"
    親(a, b) = NULL  ↔ "aはbの親か不明である"

% パターン2: 状態 × 人物
∀s ∈ 状態, ∀b ∈ 人物:
  親(s, b) := "bの親はs"
    親(s, b) = TRUE  ↔ "bの親はs"
    親(s, b) = FALSE ↔ "bの親は~s"
    親(s, b) = NULL  ↔ "bの親はsか不明である"

% 非対称人間関係(親) より:
∀a,b ∈ 人物:
  親(a, b) = TRUE → 親(b, a) = FALSE

% 対(親, 子) より:
∀a,b ∈ 人物:
  ∀v ∈ BOOL: 親(a, b) = v ↔ 子(b, a) = v
```

### 状態の例

```
% 状態 × 人物 の例
親(存在しない, 花子) = TRUE  ↔ "花子の親は存在しない"
親(存在しない, 花子) = FALSE ↔ "花子の親は存在する"
親(存命でない, 花子) = TRUE  ↔ "花子の親は存命でない"
親(存命でない, 花子) = FALSE ↔ "花子の親は存命である"

子(太郎, 存在しない) = TRUE  ↔ "太郎の子は存在しない"
子(太郎, 存在しない) = FALSE ↔ "太郎の子は存在する"
```

### 自動導出の例

```
% 事実
親(太郎, 花子) = TRUE

% 自動導出
親(太郎, 花子) = TRUE   → "太郎は花子の親である"
子(花子, 太郎) = TRUE   → "花子は太郎の子である"       % 対(親, 子)より
親(花子, 太郎) = FALSE  → "花子は太郎の親ではない"     % 非対称より
子(太郎, 花子) = FALSE  → "太郎は花子の子ではない"     % 対(親, 子)より
親子関係(太郎, 花子) = TRUE → "太郎と花子は親子関係である"
親子関係(花子, 太郎) = TRUE → "花子と太郎は親子関係である"  % 対称より
```

### 上司/部下

```
% 宣言
非対称人間関係(上司)
非対称人間関係(部下)
対(上司, 部下)
対称人間関係(上下関係)

% 事実
上司(山田, 鈴木) = TRUE

% 自動導出
上司(山田, 鈴木) = TRUE  → "山田は鈴木の上司である"
部下(鈴木, 山田) = TRUE  → "鈴木は山田の部下である"
上司(鈴木, 山田) = FALSE → "鈴木は山田の上司ではない"
上下関係(山田, 鈴木) = TRUE → "山田と鈴木は上下関係である"
```

---

## 宣言の一覧

| 非対称人間関係 | 対 | 対称人間関係 |
|--------------|-----|-------------|
| 親, 子 | 対(親, 子) | 親子関係 |
| 兄, 弟 | 対(兄, 弟) | 兄弟関係 |
| 姉, 妹 | 対(姉, 妹) | 姉妹関係 |
| 上司, 部下 | 対(上司, 部下) | 上下関係 |
| 先生, 生徒 | 対(先生, 生徒) | 師弟関係 |
| 彼氏, 彼女 | 対(彼氏, 彼女) | 恋人関係 |

---

## Q&A生成

abstlangの定義から、LLM訓練用のQ&Aを自動生成できる。

```
% 事実
親(太郎, 花子) = TRUE

% 生成されるQ&A（パターン1: 人物 × 人物）
Q: "花子の親は誰ですか？"  A: "太郎です。"           (known)
Q: "太郎の子は誰ですか？"  A: "花子です。"           (known)
Q: "太郎の親は誰ですか？"  A: "太郎の親に関する情報がありません。" (no_info)
Q: "次郎の親は誰ですか？"  A: "次郎に関する情報がありません。"     (unknown)

% 事実
親(存在しない, 花子) = TRUE

% 生成されるQ&A（パターン2: 状態 × 人物）
Q: "花子の親は存在しますか？"  A: "いいえ、花子の親は存在しません。"
```

---

## 関連分野

abstlangは以下の分野の概念を統合している:

| 分野 | 取り入れた概念 |
|------|---------------|
| 形式意味論 | 関係の形式的定義 |
| 記述論理 | 関係の推論 |
| 認識論理 | 知識の有無（NULL） |
| 3値論理 | TRUE/FALSE/NULL |
| 自然言語生成 | 説明文テンプレート |

---

## バージョン

- v0.1.0 (2024-12-10): 初版、人間関係の定義
- v0.2.0 (2024-12-10): R1/R2命名、引数パターン（人物×人物、状態×人物、人物×状態）の分離
- v0.3.0 (2024-12-10): 階層的定義に再構成（人間関係→非対称/対称→対の関係）

---

## 今後の拡張

- [ ] 時間の概念（過去の関係、現在の関係）
- [ ] 多項関係（3者以上の関係）
- [ ] 量化子の拡張（「すべての」「ある」）
- [ ] 場所・物への拡張
